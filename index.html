<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ø£Ù†ÙŠØ³ â€“ ÙÙŠØ²ÙŠØ§Ø¡</title>

<!-- Amiri Ù„Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª ÙÙ‚Ø·ØŒ Cairo Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØµÙØ­Ø© -->
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet"/>

<style>
:root{
  --ink:#0d1b12; --muted:#5c6f62;
  --leaf-25:#eef7f1; --leaf-50:#e3f1e7; --leaf-100:#d6eadc;
  --accent:#1b7d3b; --accent-2:#27a158;
  --card:#fff; --ring:#bfe6c9; --btn-shadow:rgba(39,161,88,.25);
  --sub:#0e7a43; --h:#0e7a43;
  --chip-bg:#e7f7ec; --chip-bd:#c8e9d3;
  --error-bg:#fee2e2; --error-bd:#fecaca; --error-ink:#7f1d1d;
}
html.dark{
  --ink:#e9fbea; --muted:#cfead7;
  --leaf-25:#0b1710; --leaf-50:#0d1c12; --leaf-100:#0f2216;
  --accent:#2a9a56; --accent-2:#1f7f47;
  --card:#0f1c14; --ring:#194a2d; --btn-shadow:rgba(109,208,148,.22);
  --sub:#9ce0b4; --h:#9ce0b4; --chip-bg:#143a23; --chip-bd:#19512f;
  --error-bg:#3a1010; --error-bd:#5b1a1a; --error-ink:#ffd7d7;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  font-family:"Cairo", system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
  /* Ø®Ù„ÙÙŠØ© Ø§Ù„ÙØ§ØªØ­ */
  background:
    radial-gradient(900px 520px at 10% -10%, var(--leaf-100), transparent 60%),
    radial-gradient(900px 520px at 90% 110%, var(--leaf-50), transparent 60%),
    linear-gradient(180deg, var(--leaf-25), var(--leaf-25) 85%);
  overflow-x:hidden;
}
/* Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯Ø§ÙƒÙ† â€” Ø¯Ø§ÙƒÙ†Ø© ØªÙ…Ø§Ù…Ù‹Ø§ Ù…Ù† Ø£Ø¹Ù„Ù‰ Ù„Ø£Ø³ÙÙ„ */
html.dark body{
  background:
    linear-gradient(180deg, #0a1510, #0f2216 85%);
}

/* Ø£ÙˆØ±Ø§Ù‚/Ø¯ÙˆØ§Ø¦Ø± Ù…ØªØ­Ø±ÙƒØ© Ø£ÙˆØ¶Ø­ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ÙŠÙ† */
body::before, body::after{
  content:""; position:fixed; inset:0; z-index:-1; pointer-events:none;
  background:
    radial-gradient(70px 42px at 82% 24%, rgba(27,125,59,.20) 0%, transparent 70%),
    radial-gradient(130px 72px at 20% 30%, rgba(27,125,59,.18) 0%, transparent 70%),
    radial-gradient(160px 90px at 48% 78%, rgba(27,125,59,.20) 0%, transparent 70%),
    radial-gradient(90px 60px at 12% 68%, rgba(27,125,59,.16) 0%, transparent 70%),
    radial-gradient(110px 70px at 88% 82%, rgba(27,125,59,.16) 0%, transparent 70%);
  animation:floaty 18s infinite alternate ease-in-out;
  opacity:.95;
}
html.dark body::before, html.dark body::after{
  background:
    radial-gradient(70px 42px at 82% 24%, rgba(92,184,125,.18) 0%, transparent 70%),
    radial-gradient(130px 72px at 20% 30%, rgba(92,184,125,.16) 0%, transparent 70%),
    radial-gradient(160px 90px at 48% 78%, rgba(92,184,125,.18) 0%, transparent 70%),
    radial-gradient(90px 60px at 12% 68%, rgba(92,184,125,.14) 0%, transparent 70%),
    radial-gradient(110px 70px at 88% 82%, rgba(92,184,125,.14) 0%, transparent 70%);
}
body::after{opacity:.85; animation-duration:26s; animation-delay:-6s; filter:blur(.3px) contrast(108%);}
@keyframes floaty{from{transform:translateY(0)} to{transform:translateY(26px)}}

.wrap{max-width:1100px;margin:0 auto;padding:22px;min-height:100vh;display:flex;flex-direction:column}
.theme-toggle{position:fixed;top:14px;left:14px;z-index:5;background:var(--card);color:var(--ink);
  border:1px solid var(--ring);border-radius:999px;padding:6px 10px;cursor:pointer;font-size:14px}

header{text-align:center;margin:6px 0 8px}
header .title{
  display:flex; align-items:center; gap:10px; justify-content:center;
  /* Ù†Ø¶Ù…Ù† Ø£Ù† Ø§Ù„Ø¯ÙˆØ§Ø¦Ø± ØªØ£ØªÙŠ Ø¨ØµØ±ÙŠÙ‹Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³Ù… (ÙŠÙ…ÙŠÙ†Ù‹Ø§ ÙÙŠ RTL) */
  flex-direction:row-reverse;
}
header h1{
  font-family:"Amiri", serif;
  font-size:clamp(36px,6vw,58px);
  margin:0; font-weight:700; letter-spacing:.2px; color:var(--accent);
}
.logo-dot{
  width:26px; height:26px; border-radius:50%; background:var(--accent);
  box-shadow:12px 0 0 0 var(--accent),
             24px 0 0 0 color-mix(in oklab, var(--accent) 82%, white 18%);
  margin-inline-start:6px; /* Ù…Ø³Ø§ÙØ© Ø¨Ø³ÙŠØ·Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙˆØ§Ø¦Ø± */
}

/* Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„ØªØ­ÙÙŠØ²ÙŠØ© Ø«Ø§Ø¨ØªØ© Ø§Ù„ÙˆØ¶ÙˆØ­ */
header p.subtitle{
  display:block; margin:6px auto 0;
  color:#2f513e; font-weight:600; font-size:clamp(14px,2.4vw,18px);
  text-shadow:0 1px 0 rgba(255,255,255,.25);
}
html.dark header p.subtitle{
  color:#bfead0; text-shadow:0 1px 0 rgba(0,0,0,.45);
}

.card{background:var(--card);border:1px solid var(--ring);border-radius:16px;box-shadow:0 12px 30px rgba(0,0,0,.06)}
.pad{padding:14px}
.inputs{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.input{width:min(560px,100%);padding:10px;border-radius:8px;border:1px solid var(--ring);font-size:18px;background:transparent;color:var(--ink)}
.toolbar{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:10px}
.btn{background:linear-gradient(180deg,var(--accent),var(--accent-2));color:#fff;border:none;padding:10px 14px;border-radius:12px;
  font-weight:700;cursor:pointer;box-shadow:0 10px 20px var(--btn-shadow);font-size:16px}
.btn:disabled{opacity:.6;cursor:not-allowed}

.status{color:var(--muted);font-size:.95rem;text-align:center;min-height:1.2em}
.err{background:var(--error-bg);color:var(--error-ink);border:1px solid var(--error-bd);padding:10px;border-radius:12px;display:none}

.sec{display:none;margin-top:12px}
.box{background:color-mix(in oklab, var(--leaf-50) 50%, var(--card) 50%);border:1px solid var(--ring);padding:12px;border-radius:12px}
.box ul,.box ol{margin:0 1.1rem}
.tag{display:inline-block;padding:.28rem .7rem;border-radius:999px;background:var(--chip-bg);border:1px solid var(--chip-bØ¯);color:var(--sub);font-size:.9rem}

.math-inline,.math-block{direction:ltr;unicode-bidi:isolate}
.math-block{display:block;margin:.35rem auto;text-align:center}

h2.section{color:var(--h);margin:0 0 8px 0;font-weight:700;text-align:center}
h3.sub{color:var(--sub);margin:10px 0 6px 0;font-weight:700}

.table{width:100%;border-collapse:separate;border-spacing:0;overflow:hidden;border-radius:12px;border:1px solid var(--ring)}
.table th,.table td{border-bottom:1px solid color-mix(in oklab, var(--ring) 70%, transparent 30%);padding:8px 10px;font-size:16px;text-align:center;vertical-align:middle}
.table th{background:color-mix(in oklab, var(--leaf-50) 70%, var(--card) 30%);font-weight:700}
.table tr:last-child td{border-bottom:none}
.unit-cell{direction:ltr}

.center{max-width:820px;margin:0 auto}
.pill{display:inline-block;background:color-mix(in oklab, var(--leaf-50) 60%, var(--card) 40%);border:1px solid var(--ring);border-radius:999px;padding:.25rem .6rem;margin:.12rem .25rem}

footer{margin-top:auto;text-align:center;color:var(--muted);padding:22px 0 54px}
footer .brandline{display:flex;align-items:center;gap:8px;justify-content:center;margin-top:6px}
footer .leaf-dots{width:18px;height:18px;border-radius:50%;background:var(--accent);
  box-shadow:10px 0 0 0 var(--accent),20px 0 0 0 color-mix(in oklab, var(--accent) 82%, white 18%); margin-inline:8px}
footer .quote{font-weight:700;color:var(--ink);font-size:clamp(15px,3.6vw,18px)}
html.dark footer .quote{color:#e9fbea}
footer .sig{margin-top:4px;color:var(--ink);font-size:clamp(14px,3.4vw,16px)}
</style>

<script>
window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,packages:{'[+]':['noerrors','noundefined']}}};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script src="anis.js"></script>
</head>

<body>
<button class="theme-toggle" id="themeBtn">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†</button>

<div class="wrap">
  <header>
    <div style="display:inline-flex;align-items:center;gap:12px;">
      <h1>Ø£Ù†ÙŠØ³ â€“ ÙÙŠØ²ÙŠØ§Ø¡</h1>
      <span class="logo-dot" aria-hidden="true"></span>
    </div>
    <p class="subtitle">Ø§Ù„ØªÙ…ÙŠÙ‘Ø² ÙˆØ§Ù„Ù†Ø¬Ø§Ø­ ÙŠØ¨Ø¯Ø£ Ø¨Ø®Ø·ÙˆØ©.</p>
  </header>

  <section class="card pad" style="text-align:center;">
    <div class="inputs">
      <input id="concept" class="input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†/Ø§Ù„Ù…ÙÙ‡ÙˆÙ…: Ù‚Ø§Ù†ÙˆÙ† Ù†ÙŠÙˆØªÙ† Ø§Ù„Ø«Ø§Ù†ÙŠØŒ Ø§Ù„Ø¬Ø°Ø¨ Ø§Ù„Ø¹Ø§Ù…ØŒ Ø§Ù„Ø³Ù‚ÙˆØ· Ø§Ù„Ø­Ø±â€¦"/>
    </div>
    <div class="toolbar">
      <button class="btn" id="btnExplain">Ø§Ø´Ø±Ø­ Ù„ÙŠ ğŸ“˜</button>
      <button class="btn" id="btnEx1">Ù…Ø«Ø§Ù„ ØªØ·Ø¨ÙŠÙ‚ÙŠ ğŸ’¡</button>
      <button class="btn" id="btnEx2">Ù…Ø«Ø§Ù„ Ø¢Ø®Ø± ğŸ’¡</button>
      <button class="btn" id="btnPractice">Ø§Ø®ØªØ¨Ø± ÙÙ‡Ù…ÙŠ ğŸ“</button>
      <button class="btn" id="btnSolve">Ø§Ù„Ø­Ù„ Ø§Ù„ØµØ­ÙŠØ­ ğŸ”‘</button>
    </div>
    <div id="status" class="status"></div>
    <div id="error" class="err"></div>
  </section>

  <section id="secExplain" class="sec card pad" aria-live="polite">
    <h2 id="exTitle" class="section"></h2>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin:-4px 0 10px;justify-content:center;">
      <span class="tag">ÙÙŠØ²ÙŠØ§Ø¡</span><span id="chip2" class="tag"></span>
    </div>
    <div id="overview" class="box center" style="text-align:right;line-height:1.7;"></div>

    <h3 class="sub" style="text-align:center">Ø§Ù„ØµÙŠØº</h3>
    <div id="expFormulas" class="box center"></div>

    <h3 class="sub" style="text-align:center">Ø§Ù„Ø±Ù…ÙˆØ² ÙˆØ§Ù„ÙˆØ­Ø¯Ø§Øª</h3>
    <div class="center">
      <table class="table">
        <thead><tr><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ø±Ù…Ø²</th><th>Ø§Ù„ÙˆØ­Ø¯Ø©</th></tr></thead>
        <tbody id="symbols"></tbody>
      </table>
    </div>

    <h3 class="sub" style="text-align:center">Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…/Ø§Ù„Ø­Ù„</h3>
    <ol id="steps" class="box center" style="text-align:right;line-height:1.7;"></ol>
  </section>

  <section id="secEx1" class="sec card pad"><h2 class="section">Ù…Ø«Ø§Ù„ ØªØ·Ø¨ÙŠÙ‚ÙŠ</h2><div id="ex1" class="box"></div></section>
  <section id="secEx2" class="sec card pad"><h2 class="section">Ù…Ø«Ø§Ù„ Ø¢Ø®Ø±</h2><div id="ex2" class="box"></div></section>
  <section id="secPractice" class="sec card pad"><h2 class="section">Ø§Ø®ØªØ¨Ø± ÙÙ‡Ù…ÙŠ</h2><div id="practice" class="box"></div></section>
  <section id="secSolve" class="sec card pad"><h2 class="section">Ø§Ù„Ø­Ù„ Ø§Ù„ØµØ­ÙŠØ­</h2><div id="solve" class="box"></div></section>

  <footer>
    <div class="brandline">
      <span class="leaf-dots" aria-hidden="true"></span>
      <span class="quote">Ù„ÙƒÙ„Ù‘ Ø´ÙŠØ¡Ù ØµØ¹Ø¨Ù ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§ Ø­Ù„Ù‘</span>
    </div>
    <div class="sig">Ù†Ø¯Ù‰ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ±Ø´</div>
  </footer>
</div>

<!-- ========== ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙÙ‚Ø·: Ø­Ù…Ø§ÙŠØ© LaTeX ÙˆØªØµØ­ÙŠØ­ Ø¹Ù…ÙˆØ¯ "Ø§Ù„ÙˆØ­Ø¯Ø©" ========== -->
<script>
/* Ù„Ø§ Ù†Ù„Ù…Ø³ Ø§Ù„ØªØµÙ…ÙŠÙ… â€” ÙÙ‚Ø· Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¹Ø±Ø¶ */
(function(){
  const clean = s => (s ?? '').toString().replace(/\r/g,'\n').trim();
  const fixLatex = s => clean(s).replace(/(^|[^\\])\b(frac|sqrt|mathrm|cdot)\b/g,'$1\\$2');

  function htmlWithMath(input){
    let s = fixLatex(input||'');
    const blocks=[], inlines=[];
    s = s.replace(/\$\$([\s\S]*?)\$\$/g, (_,x)=>{ blocks.push('$$'+x+'$$'); return 'Â§Â§B'+(blocks.length-1)+'Â§Â§';});
    s = s.replace(/\$([^$]+)\$/g,       (_,x)=>{ inlines.push('$'+x+'$');   return 'Â§Â§I'+(inlines.length-1)+'Â§Â§';});
    s = s.replace(/Â§Â§B(\d+)Â§Â§/g, (_,i)=>`<div class="math-block">${blocks[i]}</div>`)
         .replace(/Â§Â§I(\d+)Â§Â§/g, (_,i)=>`<span class="math-inline">${inlines[i]}</span>`);
    return s;
  }

  // ÙƒØ´Ù Ø¨Ø³ÙŠØ· Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© ØªØ¨Ø¯Ùˆ "ÙˆØ­Ø¯Ø©"
  function probablyUnit(s){
    s=(s??'')+'';
    return /\\mathrm\{|m\/s(?:\^2)?|m\^2|s\^2|kg|N|J|Pa|W|Hz|A|K|C|V|Î©|ohm/i.test(s);
  }
  function hasMathDelim(s){ return /\$|\\\(|\\\[/.test(s||''); }
  function wrapMath(s){
    s=(s??'').toString().trim();
    if(!s) return s;
    return hasMathDelim(s) ? s : `$${s}$`;
  }

  // Ø§Ø³Ù… Ø¹Ø±Ø¨ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø±Ù…Ø² Ø¥Ù† ÙƒØ§Ù† Ø§Ù„ÙˆØµÙ Ù†Ø§Ù‚Øµ
  const SYMBOL_AR = {
    'v_f':'Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©','vf':'Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©',
    'v_i':'Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©','vi':'Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©',
    'a':'Ø§Ù„ØªØ³Ø§Ø±Ø¹','g':'ØªØ³Ø§Ø±Ø¹ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©','t':'Ø§Ù„Ø²Ù…Ù†',
    'h':'Ø§Ù„Ø§Ø±ØªÙØ§Ø¹','d':'Ø§Ù„Ù…Ø³Ø§ÙØ©','s':'Ø§Ù„Ø¥Ø²Ø§Ø­Ø©',
    'm':'Ø§Ù„ÙƒØªÙ„Ø©','F':'Ø§Ù„Ù‚ÙˆØ©','W':'Ø§Ù„Ø´ØºÙ„','P':'Ø§Ù„Ù‚Ø¯Ø±Ø©'
  };
  function fillDesc(row){
    const o = { ...row };
    if(!o.desc || !o.desc.toString().trim()){
      const key = (o.symbol||'').replace(/\$/g,'').replace(/[\\{}]/g,'').trim();
      o.desc = SYMBOL_AR[key] || 'â€”';
    }
    return o;
  }

  // ÙŠØ¹ÙŠØ¯ ØªØ±ØªÙŠØ¨ Ø§Ù„ØµÙ Ø¥Ø°Ø§ Ù‡Ø±Ø¨Øª Ø§Ù„ÙˆØ­Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙˆØµÙØŒ ÙˆÙŠØ¶Ù…Ù† Ù„ÙÙ‘Ù‡Ø§ Ø¨Ù€ $
  function normalizeRow(row){
    let o = { ...row };
    if ((!o.unit || !o.unit.toString().trim()) && probablyUnit(o.desc)) {
      o.unit = o.desc; o.desc = 'â€”';
    }
    if (o.unit) o.unit = wrapMath(o.unit);
    return fillDesc(o);
  }

  // ØªØ¹Ø±ÙŠØ¨ Ø³Ø±ÙŠØ¹ Ù„Ø¹Ø¨Ø§Ø±Ø§Øª Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø´Ø§Ø¦Ø¹Ø© ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ§Øª (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¹Ù†Ù‰)
  function arabize(text=''){
    let s = (text||'')+'';
    const repl = [
      [/Using the equation of motion/gi,'Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø­Ø±ÙƒØ©'],
      [/Substituting the given values/gi,'Ø¨Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø¹Ø·Ø§Ø©'],
      [/where/gi,'Ø­ÙŠØ«'],
      [/final velocity/gi,'Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©'],
      [/initial velocity/gi,'Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©'],
      [/acceleration due to gravity/gi,'ØªØ³Ø§Ø±Ø¹ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©'],
      [/height/gi,'Ø§Ù„Ø§Ø±ØªÙØ§Ø¹'],
      [/To find/gi,'Ù„Ø¥ÙŠØ¬Ø§Ø¯'],
      [/we take the square root of both sides/gi,'Ù†Ø£Ø®Ø° Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ Ù„Ù„Ø·Ø±ÙÙŠÙ†'],
      [/therefore|so/gi,'ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ']
    ];
    repl.forEach(([a,b])=>{ s = s.replace(a,b); });

    // ØªÙˆØ­ÙŠØ¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ù„Ø¹Ø±Ø¶ Ø±ÙŠØ§Ø¶ÙŠ
    s = s.replace(/\bm\/s\^2\b/g,'$\\mathrm{m/s^2}$')
         .replace(/\bm\/s\b/g,'$\\mathrm{m/s}$')
         .replace(/\bm\^2\b/g,'$\\mathrm{m^2}$')
         .replace(/\bm\b/g,'$\\mathrm{m}$');

    return s;
  }

  // Ù†ÙƒØ´Ù Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø¨Ù‚ÙŠØ© Ø§Ù„Ø³ÙƒØ±Ø¨Øª
  window.MATH = { htmlWithMath, normalizeRow, wrapMath, arabize };
})();
</script>

<script>
(function(){
  const H = (s)=>window.MATH.htmlWithMath(s);

  function renderGivenUnknowns(givens=[], unknowns=[]){
    const tbl=document.createElement('table'); tbl.className='table center';
    tbl.innerHTML=`<thead><tr><th>Ø§Ù„Ø±Ù…Ø²</th><th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th><th>Ø§Ù„ÙˆØ­Ø¯Ø©</th><th>Ø§Ù„ÙˆØµÙ</th></tr></thead>`;
    const tb=document.createElement('tbody');

    (givens||[]).map(window.MATH.normalizeRow).forEach(g=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`
        <td>${H(g.symbol||'')}</td>
        <td>${H(g.value||'')}</td>
        <td class="unit-cell">${H(window.MATH.wrapMath(g.unit||''))}</td>
        <td>${H(g.desc||'')}</td>`;
      tb.appendChild(tr);
    });

    if((unknowns||[]).length){
      const tr=document.createElement('tr'); const td=document.createElement('td'); td.colSpan=4; td.innerHTML='<span class="pill">Ø§Ù„Ù…Ø¬Ø§Ù‡ÙŠÙ„</span>';
      tr.appendChild(td); tb.appendChild(tr);
      (unknowns||[]).map(window.MATH.normalizeRow).forEach(u=>{
        const r=document.createElement('tr');
        r.innerHTML=`
          <td>${H(u.symbol||'')}</td>
          <td>ØŸ</td>
          <td class="unit-cell">â€”</td>
          <td>${H(u.desc||'')}</td>`;
        tb.appendChild(r);
      });
    }
    tbl.appendChild(tb); return tbl;
  }

  function renderFormulasBox(list=[]){
    const box=document.createElement('div'); box.className='box center';
    (list||[]).forEach(f=>{
      const d=document.createElement('div'); d.className='math-block';
      const eq=/^\$\$/.test(f)?f:`$$${(f||'').replace(/^\$|\$$/g,'')}$$`;
      d.innerHTML=H(eq); box.appendChild(d);
    });
    return box;
  }

  function renderCase(containerId, data){
    const root=document.getElementById(containerId); root.innerHTML=''; const frag=document.createDocumentFragment();

    // Ø§Ù„Ù…Ø³Ø£Ù„Ø© â€” Ù„Ùˆ Ù…Ø§ Ø±Ø¬Ø¹Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ù†Ø³ØªØ®Ø¯Ù… Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„ Ù…ÙÙˆÙ„ÙÙ‘Ø¯
    const fallbackQ = (window.LPQ || window.LAST_PRACTICE_QUESTION || '');
    const qText = data.scenario || data.question || fallbackQ || 'â€”';
    const s1=document.createElement('div');
    s1.innerHTML = `<div class="sub">Ø§Ù„Ù…Ø³Ø£Ù„Ø©</div><div class="box">${H(qText)}</div>`;
    frag.appendChild(s1);

    const s2=document.createElement('div'); s2.className='sub'; s2.textContent='Ø§Ù„Ù…Ø¹Ø·ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø¬Ø§Ù‡ÙŠÙ„';
    const b2=document.createElement('div'); b2.className='box';
    b2.appendChild(renderGivenUnknowns(data.givens||[], data.unknowns||[]));
    frag.appendChild(s2); frag.appendChild(b2);

    const s3=document.createElement('div'); s3.className='sub'; s3.textContent='Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†/Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©';
    const b3=renderFormulasBox(data.formulas||(data.formula?[data.formula]:[]));
    frag.appendChild(s3); frag.appendChild(b3);

    const s4=document.createElement('div'); s4.className='sub'; s4.textContent='Ø§Ù„Ø­Ù„ ÙˆØ§Ù„Ø®Ø·ÙˆØ§Øª';
    const b4=document.createElement('div'); b4.className='box';
    const ol=document.createElement('ol');
    (data.steps||[]).forEach(step=>{
      const li=document.createElement('li');
      li.innerHTML = H(window.MATH.arabize(step));
      ol.appendChild(li);
    });
    if((data.steps||[]).length) b4.appendChild(ol);

    if(data.result){
      const hr=document.createElement('div'); hr.style.height='1px'; hr.style.background='color-mix(in oklab, var(--ring) 70%, transparent 30%)'; hr.style.margin='8px 0';
      b4.appendChild(hr);
      const big=document.createElement('div'); big.className='math-block';
      const eq=/^\$\$/.test(data.result)?data.result:`$$${data.result.replace(/^\$|\$$/g,'')}$$`;
      big.innerHTML=H(eq); b4.appendChild(big);
    }

    frag.appendChild(s4); frag.appendChild(b4);
    root.appendChild(frag);
    if(window.MathJax?.typesetPromise) MathJax.typesetPromise();
  }

  function renderExplain(d,concept){
    document.getElementById('exTitle').textContent=d.title||concept||''; document.getElementById('chip2').textContent=concept||'';
    document.getElementById('overview').innerHTML=H(d.overview||'â€”');
    const expF=document.getElementById('expFormulas'); expF.innerHTML=''; expF.appendChild(renderFormulasBox(d.formulas||[]));

    const tb=document.getElementById('symbols'); tb.innerHTML='';
    (d.symbols||[]).map(window.MATH.normalizeRow).forEach(s=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`
        <td>${H(s.desc||'')}</td>
        <td>${H(s.symbol||'')}</td>
        <td class="unit-cell">${H(window.MATH.wrapMath(s.unit||''))}</td>`;
      tb.appendChild(tr);
    });

    const st=document.getElementById('steps'); st.innerHTML='';
    (d.steps||[]).forEach(s=>{const li=document.createElement('li'); li.innerHTML=H(window.MATH.arabize(s)); st.appendChild(li);});
    document.getElementById('secExplain').style.display='block';
    if(window.MathJax?.typesetPromise) MathJax.typesetPromise();
  }

  window.UI={renderCase, renderExplain, H};
})();
</script>
(function(){
  const $=id=>document.getElementById(id);
  const secs=['secExplain','secEx1','secEx2','secPractice','secSolve'];
  function hideAll(){ secs.forEach(id=>$(id).style.display='none'); const e=$('error'); e.style.display='none'; e.textContent=''; }
  function setBusy(t){ $('status').textContent=t||''; document.querySelectorAll('.btn').forEach(b=>b.disabled=!!t); }
  function showErr(m){ const e=$('error'); e.style.display='block'; e.textContent=m||'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.'; }
  const btnTheme=$('themeBtn');
  function applyTheme(){ const dark=localStorage.getItem('theme')==='dark';
    document.documentElement.classList.toggle('dark',dark);
    btnTheme.textContent=dark?'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­':'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†';
  }
  btnTheme.addEventListener('click',()=>{ const now=localStorage.getItem('theme')==='dark'?'light':'dark'; localStorage.setItem('theme',now); applyTheme(); });
  applyTheme();
  let LAST_PRACTICE_QUESTION='';
  const actionMap={ explain:'explain', ex1:'example', ex2:'example2', practice:'practice', solve:'solve' };
  async function call(action, extra){
    const concept=($('concept').value||'').trim();
    if(!concept){ showErr('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†/Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø£ÙˆÙ„Ù‹Ø§.'); return null; }
    setBusy({explain:'Ø¬Ø§Ø±Ù ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø´Ø±Ø­â€¦',ex1:'Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø«Ø§Ù„â€¦',ex2:'Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø«Ø§Ù„ Ø§Ù„Ø¢Ø®Ø±â€¦',practice:'Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ¯Ø±ÙŠØ¨â€¦',solve:'Ø¬Ø§Ø±Ù Ø§Ù„Ø­Ù„â€¦'}[action]||'Ø¬Ø§Ø±Ù Ø§Ù„Ø¹Ù…Ù„â€¦');
    try{
      const res=await fetch('/.netlify/functions/anees',{method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify({action:actionMap[action]||action,concept,question:(extra&&extra.question)||null})});
      const txt=await res.text(); let json=null; try{ json=JSON.parse(txt); }catch(_){}
      if(!res.ok){
        const errMsg = (json&&json.error) ? json.error : (txt.slice(0,300)||('HTTP '+res.status));
        throw new Error(errMsg);
      }
      if(!json){ throw new Error('Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….'); }
      const payload=json.data||json; if(payload.error){ throw new Error(payload.error); } return payload;
    }catch(err){
      showErr(err.message||'Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.'); return null;
    }finally{ setBusy(''); }
  }
  $('btnExplain').addEventListener('click', async ()=>{ hideAll(); const d=await call('explain'); if(!d) return; UI.renderExplain(d,$('concept').value); });
  $('btnEx1').addEventListener('click', async ()=>{ hideAll(); const d=await call('ex1'); if(!d) return; UI.renderCase('ex1',d); $('secEx1').style.display='block'; });
  $('btnEx2').addEventListener('click', async ()=>{ hideAll(); const d=await call('ex2'); if(!d) return; UI.renderCase('ex2',d); $('secEx2').style.display='block'; });
  $('btnPractice').addEventListener('click', async ()=>{ hideAll(); const d=await call('practice'); if(!d) return;
LAST_PRACTICE_QUESTION = d.question || '';
window.LPQ = LAST_PRACTICE_QUESTION;   // â† Ø¬Ø¯ÙŠØ¯: Ù†Ø®Ø²Ù† Ù†Ø³Ø®Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§Ø­Ù‚Ù‹Ø§
$('practice').innerHTML = UI.H(LAST_PRACTICE_QUESTION || 'â€”');
  });
  $('btnSolve').addEventListener('click', async ()=>{ hideAll();
    if(!LAST_PRACTICE_QUESTION){ showErr('Ø§Ø¹Ø±Ø¶ÙŠ Ø£ÙˆÙ„Ø§Ù‹ Ø³Ø¤Ø§Ù„ "Ø§Ø®ØªØ¨Ø± ÙÙ‡Ù…ÙŠ" Ø«Ù… Ø§Ø¶ØºØ·ÙŠ "Ø§Ù„Ø­Ù„ Ø§Ù„ØµØ­ÙŠØ­".'); return; }
    const d=await call('solve',{question:LAST_PRACTICE_QUESTION}); if(!d) return;
    UI.renderCase('solve',d); $('secSolve').style.display='block';
  });
})();
</script>
</body>
</html>
